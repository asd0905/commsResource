var SnsDropdownApp=function(){function n(n){void 0===n&&(n={}),this.snsDataList=[{snsName:"facebook",snsTitle:"페이스북",snsImg:"//update.coolmessenger.com/_ImageServer/cooledu/icon_facebook.png"},{snsName:"twitter",snsTitle:"트위터",snsImg:"//update.coolmessenger.com/_ImageServer/cooledu/icon_twitter.png"},{snsName:"blog",snsTitle:"네이버 블로그",snsImg:"//update.coolmessenger.com/_ImageServer/cooledu/icon_blog.png"},{snsName:"band",snsTitle:"네이버 밴드",snsImg:"//update.coolmessenger.com/_ImageServer/cooledu/icon_band.jpg"}],this.snsImg="",this.snsTitle="",this.serviceName="",n.snsData&&this.snsDataList.push(n.snsData),this.snsImg=n.snsImg?n.snsImg:"//update.coolmessenger.com//_ImageServer/coolschool/facebook_link.png",this.snsTitle=n.snsTitle?n.snsTitle:"교육콘텐츠 제공 통합플랫폼",this.serviceName=n.serviceName?n.serviceName:"coolschool",function(){"use strict";var n,e={name:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0,encodeHTMLSource:function(n){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},o=n?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(n){return n?n.toString().replace(o,function(n){return e[n]||n}):""}}};n=function(){return this||(0,eval)("this")}.apply(this),"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):n.doT=e;var o={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},t=/$^/;function s(n){return n.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}e.template=function(r,a,i){var d,p,l=(a=a||e.templateSettings).append?o.append:o.split,c=0,u=a.use||a.define?function n(e,o,s){return("string"==typeof o?o:o.toString()).replace(e.define||t,function(n,o,t,r){return 0===o.indexOf("def.")&&(o=o.substring(4)),o in s||(":"===t?(e.defineParams&&r.replace(e.defineParams,function(n,e,t){s[o]={arg:e,text:t}}),o in s||(s[o]=r)):new Function("def","def['"+o+"']="+r)(s)),""}).replace(e.use||t,function(o,t){e.useParams&&(t=t.replace(e.useParams,function(n,e,o,t){if(s[o]&&s[o].arg&&t){var r=(o+":"+t).replace(/'|\\/g,"_");return s.__exp=s.__exp||{},s.__exp[r]=s[o].text.replace(new RegExp("(^|[^\\w$])"+s[o].arg+"([^\\w$])","g"),"$1"+t+"$2"),e+"def.__exp['"+r+"']"}}));var r=new Function("def","return "+t)(s);return r?n(e,r,s):r})}(a,r,i||{}):r;u=("var out='"+(a.strip?u.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):u).replace(/'|\\/g,"\\$&").replace(a.interpolate||t,function(n,e){return l.start+s(e)+l.end}).replace(a.encode||t,function(n,e){return d=!0,l.startencode+s(e)+l.end}).replace(a.conditional||t,function(n,e,o){return e?o?"';}else if("+s(o)+"){out+='":"';}else{out+='":o?"';if("+s(o)+"){out+='":"';}out+='"}).replace(a.iterate||t,function(n,e,o,t){return e?(c+=1,p=t||"i"+c,e=s(e),"';var arr"+c+"="+e+";if(arr"+c+"){var "+o+","+p+"=-1,l"+c+"=arr"+c+".length-1;while("+p+"<l"+c+"){"+o+"=arr"+c+"["+p+"+=1];out+='"):"';} } out+='"}).replace(a.evaluate||t,function(n,e){return"';"+s(e)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),d&&(a.selfcontained||!n||n._encodeHTML||(n._encodeHTML=e.encodeHTMLSource(a.doNotSkipEncoded)),u="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+e.encodeHTMLSource.toString()+"("+(a.doNotSkipEncoded||"")+"));"+u);try{return new Function(a.varname,u)}catch(r){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+u),r}},e.compile=function(n,o){return e.template(n,null,o)}}.apply(this)}return n.prototype.start=function(){var n=this.doT.template(this.getSnsDropdownTemplate());$(".snsDropdown").append(n({snsDataList:this.snsDataList})),this.clickEvent(),this.dropdownToggle(".sns-dropdown-btn",".sns-dropdown-dropdown"),this.dropdownShwoOff(".sns-dropdown-dropdown",this.targetSnsBtnCheck)},n.prototype.targetSnsBtnCheck=function(n){var e=!1;switch(n){case"sns-dropdown-btn":case"sns-dropdown-img":e=!0}return e},n.prototype.dropdownToggle=function(n,e){var o=this;$(""+n).click(function(){ga("send","event","link",o.serviceName,"sns_dropdown_btn"),$(""+e).toggleClass("show"),$(n).hasClass("show")||o.getBitlyUrl(".short-url-input")})},n.prototype.dropdownShwoOff=function(n,e){var o=this;$(window).click(function(o){if(!e(o.target.className)){var t=$(""+n);t.hasClass("show")&&t.removeClass("show")}}),$(""+n).click(function(n){"a"!==n.target.parentNode.tagName.toLowerCase()&&"a"!==n.target.tagName.toLowerCase()&&-1===n.target.className.indexOf("dropdown-close")&&o.preventClickEvent(n)})},n.prototype.preventClickEvent=function(n){n.preventDefault(),n.stopPropagation()},n.prototype.clickEvent=function(){var n=this,e=$(".sns-dropdown-dropdown");e.find(".short-url-btn").click(function(){ga("send","event","link",n.serviceName,"short_url_btn"),n.urlCopyClipboard(".short-url-input")}),e.find(".sns-item").click(function(e){var o=e.target.getAttribute("data-sns-type");n.setSnsShareData(o)})},n.prototype.urlCopyClipboard=function(n){var e=document.querySelector(n),o=document.createElement("textarea");document.body.appendChild(o),o.value=e.value,o.select(),o.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(o),alert("복사 되었습니다. ")},n.prototype.getBitlyUrl=function(n){if(!$(n).val()){var e=document.location.href,o="https://api-ssl.bitly.com/v3/shorten?access_token=6c9dde76a905863abc379017eeeebc29e072ae53&longUrl="+encodeURIComponent(e)+"&format=json";$.getJSON(o,function(e,o){"OK"===e.status_txt?$(""+n).val(e.data.url):$(""+n).val("short url을 만들기에 적적한 url이 아닙니다.")})}},n.prototype.getSnsDropdownTemplate=function(){return'\n            <style>\n                .snsDropdown { position: relative; }\n                .sns-dropdown-dropdown[snsDropdown] * {\n                    margin: 0;\n                    padding: 0;\n                    box-sizing: border-box;\n                }\n                .sns-dropdown-dropdown[snsDropdown] {\n                    padding: 25px 30px;\n                    background-color: #fff;\n                    border: 1px solid #e6e2e2;\n                    max-width: 330px;\n                    display: none;\n                    position: absolute;\n                    top: 32px;\n                    min-width: 280px;\n                    z-index: 999;\n                }\n                .snsDropdown .sns-dropdown-btn {\n                    display: inline-block;\n                    height: 31px;\n                    line-height: 29px;\n                    -webkit-border-radius: 4px;\n                    -moz-border-radius: 4px;\n                    border-radius: 4px;\n                    font-size: 14px;\n                    cursor: pointer;\n                    background-color: #ffffff;\n                    border: 1px solid #c4c4c4;\n                    color: #323232;\n                    font-weight: bold;\n                    padding: 0 20px;\n                    transition: opacity 0.2s, box-shadow 0.2s;\n                    text-align: center;\n                    letter-spacing: -0.5px;\n                }\n                .snsDropdown .sns-dropdown-btn .sns-dropdown-img {\n                    vertical-align: middle;\n                    width: 15px;\n                    height: 14px;\n                }\n                .sns-dropdown-dropdown[snsDropdown].show {\n                    display: block;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-list {\n                    list-style: none;\n                    overflow: hidden;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-list .sns-item {\n                    margin-right: 10px;\n                    cursor: pointer;\n                    float: left;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-list .sns-item:last-child {\n                    margin-right: 0;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-list .sns-item .sns-img {\n                    display: block;\n                    width: 40px;\n                    height: 40px;\n                    -webkit-border-radius: 50%;\n                    -moz-border-radius: 50%;\n                    border-radius: 50%;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-short-url {\n                    height: 35px;\n                    background-color: #f9f9f9;\n                    border: 1px solid #dfdfdf;\n                    color: #000;\n                    margin-top: 14px;\n                    margin-bottom: 12px;\n                    overflow: hidden;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-short-url .short-url-input {\n                    background-color: transparent;\n                    color: #323232;\n                    height: 35px;\n                    line-height: 35px;\n                    font-size: 12px;\n                    padding: 0 10px;\n                    width: 80%;\n                    float: left;\n                    border: 0;\n                    outline: none;\n                }\n                .sns-dropdown-dropdown[snsDropdown] .sns-short-url .short-url-btn {\n                    border-left: 1px solid #dfdfdf;\n                    color: #323232;\n                    font-size: 13px;\n                    line-height: 35px;\n                    display: inline-block;\n                    text-align: center;\n                    padding: 0;\n                    width: 20%;\n                    float: left;\n                    background-color: #ffffff;\n                    cursor: pointer;\n                }\n            </style>\n            <div class="sns-dropdown-dropdown" snsDropdown>\n                <ul class="sns-list">\n                    {{ for(var idx in it.snsDataList) { }}\n                    <li class="sns-item" data-sns-type="{{=it.snsDataList[idx].snsName}}">\n                        <img class="sns-img" src="{{=it.snsDataList[idx].snsImg}}" alt="img" data-sns-type="{{=it.snsDataList[idx].snsName}}" title="{{=it.snsDataList[idx].snsTitle}}" />    \n                    </li>\n                    {{ } }}\n                </ul>\n                <div class="sns-short-url">\n                    <input readonly="readonly" type="text" class="short-url-input"> \n                    <span class="short-url-btn">복사</span>\n                </div>\n            </div>\n        '},n.prototype.setSnsShareData=function(n){ga("send","event","link",this.serviceName,"sns-dropdown-item");var e={txt:this.snsTitle,name:n,img:this.snsImg};this.snsSharing(e)},n.prototype.snsSharing=function(n){var e={},o=n.name,t=document.location.href;n.href&&(t=n.href);var s=n.txt,r=encodeURIComponent(t),a=encodeURIComponent(s),i=encodeURIComponent("\r\n"),d=n.img;switch(o){case"facebook":e={method:"popup",url:"//www.facebook.com/sharer/sharer.php?u="+r};break;case"twitter":e={method:"popup",url:"//twitter.com/intent/tweet?text="+a+"&url="+r};break;case"google":e={method:"popup",url:"//plus.google.com/share?url="+r+"&image="+d};break;case"blog":e={method:"popup",url:"//share.naver.com/web/shareView.nhn?url="+r+"&title="+a};break;case"band":e={method:"web2app",param:"create/post?text="+a+i+r,a_store:"itms-apps://itunes.apple.com/app/id542613198?mt=8",g_store:"market://details?id=com.nhn.android.band",a_proto:"bandapp://",g_proto:"scheme=bandapp;package=com.nhn.android.band"};break;default:return void alert("지원하지 않는 SNS입니다.")}switch(e.method){case"popup":window.open(e.url,"share_"+o,"resizable=no");break;case"web2app":if(navigator.userAgent.match(/android/i))setTimeout(function(){location.href="intent://"+e.param+"#Intent;"+e.g_proto+";end"});else if(navigator.userAgent.match(/(iphone)|(ipod)|(ipad)/i))setTimeout(function(){location.href=e.a_store}),setTimeout(function(){location.href=e.a_proto+e.param});else{if("band"===o){var p=a+" | "+r;return void window.open("http://www.band.us/plugin/share?body="+p,"share_band","width=410, height=540, resizable=no")}alert("이 기능은 모바일에서만 사용할 수 있습니다.")}}},n}();
